# 核心文件内容总结

## 📁 core/ 目录文件说明

### 1. `led.py` - LED光照系统模型
**功能**: LED照明系统的物理建模和仿真

**主要类**:
- `LEDSystem`: LED系统类，封装物理参数和状态

**核心方法**:
- `step(pwm_percent, dt)`: 单步仿真，更新温度状态
- `steady_state(pwm_percent)`: 计算稳态值
- `reset()`: 重置系统温度

**物理模型**:
- 一阶热动态模型
- LED光效模型（考虑高功率时效率下降）
- 精确的离散时间更新公式

**用途**: 为MPC/MPPI控制器提供准确的LED物理模型

---

### 2. `mppi_api.py` - MPPI控制API接口
**功能**: 简化的MPPI控制接口，用于快速集成

**主要函数**:
- `mppi_next_ppfd(current_ppfd, temperature, co2, humidity)`: 计算下一个PPFD设定值

**控制算法**:
- 基于采样的模型预测路径积分控制
- 随机优化控制序列
- 约束处理和温度保护

**参数配置**:
- 预测时域: 10步
- 采样数量: 800个
- 成本权重: 光合作用、PWM、功率、平滑性

**用途**: 为其他系统提供简化的MPPI控制接口

---

### 3. `mpc.py` - 传统MPC控制器
**功能**: 基于优化的模型预测控制

**主要类**:
- `LEDPlant`: LED植物模型类
- `MPCController`: MPC控制器类

**控制算法**:
- 确定性优化控制
- 约束优化求解
- 稳定性理论保证

**优化目标**:
- 最大化光合作用速率
- 最小化控制努力
- 满足温度和PWM约束

**用途**: 提供理论保证的精确控制方案

---

### 4. `mppi.py` - 完整MPPI实现
**功能**: 完整的MPPI控制算法实现

**主要类**:
- `LEDPlant`: LED植物模型类
- `MPPIController`: MPPI控制器类

**控制算法**:
- 随机采样优化
- 软约束处理
- 实时控制能力

**关键特性**:
- 可调节的采样参数
- 自适应控制策略
- 鲁棒性控制

**用途**: 复杂环境下的智能控制

---

## 🔧 模块间关系

```
led.py (物理模型)
    ↓
mppi_api.py (简化接口)
    ↓
mppi.py (完整实现)
    ↓
mpc.py (替代方案)
```

## 📊 控制算法对比

| 控制器 | 计算速度 | 控制精度 | 稳定性 | 适用场景 |
|--------|----------|----------|--------|----------|
| MPPI API | 最快 | 高 | 好 | 实时控制 |
| MPPI | 快 | 很高 | 很好 | 复杂控制 |
| MPC | 中等 | 高 | 最好 | 精确控制 |

## 🎯 使用建议

### 选择 MPPI API 当:
- 需要快速集成
- 实时控制要求高
- 简单应用场景

### 选择 完整MPPI 当:
- 需要自定义参数
- 复杂控制需求
- 研究开发

### 选择 MPC 当:
- 需要理论保证
- 稳定性要求高
- 确定性控制

## 📈 技术特点

### 物理建模
- **LED热效应**: 考虑LED发热对温度的影响
- **光效模型**: 高功率时光效下降
- **环境响应**: 温度、CO2、湿度影响

### 控制算法
- **MPPI**: 基于随机采样的模型预测控制
- **MPC**: 基于优化的模型预测控制
- **约束处理**: 温度、功率、PWM约束

### 优化目标
- **主要目标**: 最大化光合作用速率
- **次要目标**: 最小化能耗和温度偏差
- **约束条件**: 物理限制和安全约束

## 🔬 应用场景

### 科研应用
- 植物生理研究
- 环境控制优化
- 数据收集分析

### 商业应用
- 温室种植管理
- 垂直农场控制
- 植物工厂优化

### 教育应用
- 控制理论教学
- 农业技术展示
- 系统集成案例

## ⚠️ 注意事项

1. **参数调优**: 不同应用场景需要调整控制参数
2. **模型依赖**: 需要准确的环境和植物模型
3. **计算资源**: MPPI需要较多计算资源
4. **实时性**: 确保控制循环的实时性要求
5. **中文注释**: 所有文件已添加完整的中文注释，便于理解和使用
